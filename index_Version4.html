<!DOCTYPE html>
<html lang="sw">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>WIFI Mtaani | Internet Popote</title>

  <!-- Tailwind (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            mtaaniBrown: '#5D4037',
            mtaaniGrey: '#E0E0E0',
          }
        }
      }
    }
  </script>

  <!-- Leaflet for map -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    integrity="sha256-sA+e2kG6m2t8zR2S6mTqf1K3Qh5mXk9k+7fJkG3zD0o=" crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
    integrity="sha256-o9N1jzO2l6/7yq3j2Ls0uQ2qQXG3LQ3QZlqzj9x0/5M=" crossorigin=""></script>

  <style>
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans"; }
    #map { height: 60vh; min-height: 320px; }
    .highlight { box-shadow: 0 0 0 3px rgba(93,64,55,0.18); }
  </style>
</head>
<body class="bg-white min-h-screen text-gray-800">
  <div class="max-w-5xl mx-auto p-6">
    <header class="flex items-center justify-between">
      <div>
        <h1 class="text-2xl font-bold text-mtaaniBrown">WIFI Mtaani</h1>
        <p class="text-sm text-gray-600">Internet popote â€” ongeza na ungana kwa urahisi.</p>
      </div>
      <div class="flex gap-2 items-center">
        <button id="themeToggle" class="px-3 py-1 bg-mtaaniBrown text-white rounded hover:opacity-90">Dark</button>
      </div>
    </header>

    <main class="mt-6 grid gap-6">
      <!-- Form: Add hotspot -->
      <section class="bg-gray-50 p-4 rounded shadow-sm">
        <h2 class="font-semibold mb-2">Ongeza Hotspot</h2>
        <form id="hotspotForm" class="grid gap-2 sm:grid-cols-2">
          <input id="name" required placeholder="Jina la mahali (mf. Kituo A)" class="p-2 border rounded" />
          <input id="ssid" required placeholder="SSID (mf. WIFI_MTAANI)" class="p-2 border rounded" />
          <input id="password" placeholder="Password (ukae wazi au iachi tupu)" class="p-2 border rounded" />
          <input id="location" placeholder="Eneo/Anwani (hi.)" class="p-2 border rounded" />
          <input id="lat" placeholder="Lat (hi. -1.2921)" class="p-2 border rounded" />
          <input id="lng" placeholder="Lng (hi. 36.8219)" class="p-2 border rounded" />
          <div class="sm:col-span-2 flex gap-2">
            <button type="submit" class="px-4 py-2 bg-mtaaniBrown text-white rounded">Ongeza</button>
            <button id="clearAll" type="button" class="px-4 py-2 bg-gray-200 rounded">Futa zote</button>
            <input id="search" placeholder="Tafuta..." class="ml-auto p-2 border rounded" />
          </div>
        </form>
        <p class="text-xs text-gray-500 mt-2">Chagua lat/lng ili kuonyesha kwenye ramani. Format: decimal (mf. -1.2921, 36.8219).</p>
      </section>

      <!-- Tabs -->
      <nav class="flex gap-2">
        <button id="tabList" class="px-3 py-1 bg-mtaaniBrown text-white rounded">Orodha</button>
        <button id="tabMap" class="px-3 py-1 bg-gray-200 rounded">Ramani</button>
      </nav>

      <!-- List -->
      <section id="panelList">
        <h3 class="font-semibold mb-2">Hotspots</h3>
        <div id="list" class="grid gap-3"></div>
        <p id="emptyMsg" class="text-sm text-gray-500 mt-3 hidden">Hakuna hotspots. Ongeza moja juu.</p>
      </section>

      <!-- Map -->
      <section id="panelMap" class="hidden">
        <h3 class="font-semibold mb-2">Ramani ya Hotspots</h3>
        <div id="map" class="rounded border"></div>
        <p class="text-sm text-gray-500 mt-2">Bonyeza marker kuona maelezo. Hotspots bila lat/lng hazijaonyeshwa ramani.</p>
      </section>
    </main>
  </div>

  <!-- Toast -->
  <div id="toast" class="fixed bottom-6 right-6 bg-black text-white px-4 py-2 rounded opacity-0 pointer-events-none transition-opacity"></div>

  <script>
    (function () {
      // Simple interactive logic: add/list/search/copy/delete/share/map, persisted in localStorage
      const STORAGE_KEY = 'mtaani_hotspots_v2';
      const form = document.getElementById('hotspotForm');
      const listEl = document.getElementById('list');
      const emptyMsg = document.getElementById('emptyMsg');
      const searchInput = document.getElementById('search');
      const clearAllBtn = document.getElementById('clearAll');
      const toastEl = document.getElementById('toast');
      const themeToggle = document.getElementById('themeToggle');

      const tabList = document.getElementById('tabList');
      const tabMap = document.getElementById('tabMap');
      const panelList = document.getElementById('panelList');
      const panelMap = document.getElementById('panelMap');

      // Map state
      let map, markersLayer;

      // theme toggle (light/dark)
      let dark = false;
      themeToggle.addEventListener('click', () => {
        dark = !dark;
        document.documentElement.classList.toggle('dark', dark